
<!DOCTYPE html>




<html lang="en">
  <head>
    <meta charset="utf-8" />
    
    <title>numba.transforms &mdash; numba 0.7.2-284-g9bab146-dirty documentation</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    
<link rel="stylesheet" href="../_static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" href="../_static/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="../_static/css/font-awesome.min.css">
<!--[if IE 7]>
<link rel="stylesheet" href="../_static/css/font-awesome-ie7.min.css">
<![endif]-->
<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
}
</style>
<link rel="stylesheet" href="../_static/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
<link rel="stylesheet" href="../_static/css/bootstrap-responsive.min.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    '../',
            VERSION:     '0.7.2-284-g9bab146-dirty',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="../_static/js/jquery.min.js"></script>
<script type="text/javascript" src="../_static/underscore.js"></script>
<script type="text/javascript" src="../_static/doctools.js"></script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript" src="../_static/js/bootstrap.min.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    $('.show-sidebar').click(function(e) {
       e.preventDefault();
       if ($(".show-sidebar").html() == "Open Table Of Contents") {
          $('.for-mobile').removeClass('hidden-phone');
          $(".show-sidebar").html("Close Table Of Contents");
       } else {
          $(".show-sidebar").html("Open Table Of Contents");
       }
    });
  });
</script>
    <link rel="top" title="numba 0.7.2-284-g9bab146-dirty documentation" href="../index.html" /> 
  </head>
  <body>
    <div class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">numba 0.7.2-284-g9bab146-dirty documentation</a>
          <div class="nav-collapse collapse">
            <ul class="nav pull-right">
              
                <li>
                <a href="../genindex.html" title="General Index" accesskey="I">index</a>
                </li>
                <li>
                <a href="../py-modindex.html" title="Python Module Index" >modules</a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </div>
    

    <!-- container -->
    <div class="container-fluid">


      
      <div class="row-fluid hidden-desktop hidden-tablet">
      
<div class="span3 ">
  <a class="visible-phone btn btn-small show-sidebar" data-toggle="collapse" data-target=".for-mobile">Open Table Of Contents</a>
  <div class="for-mobile sidebar hidden-phone">
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/modules/transforms.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox">
  <h3>Quick search</h3>
  <form class="search form-search" action="../search.html" method="get">
      <div class="input-append">
        <input type="text" class="search-query" name="q">
        <input type="submit" class="btn" value="Go" />
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div>
      </div>
      

      <!-- row -->
      <div class="row-fluid">
         
<div class="span3 visible-desktop visible-tablet">
  <div class=" sidebar hidden-phone">
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/modules/transforms.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox">
  <h3>Quick search</h3>
  <form class="search form-search" action="../search.html" method="get">
      <div class="input-append">
        <input type="text" class="search-query" name="q">
        <input type="submit" class="btn" value="Go" />
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div> 
        

        <div class="span9">
          <div class="document">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  
  <div class="section" id="module-numba.transforms">
<span id="numba-transforms"></span><h1>numba.transforms<a class="headerlink" href="#module-numba.transforms" title="Permalink to this headline">¶</a></h1>
<p>This module provides a variety of transforms that transform the AST
into a final form ready for code generation.</p>
<p>Below follows an explanation and justification of the design of the main
compilation stages in numba.</p>
<p>We start with a Python AST, compiled from source code or decompiled from
bytecode using meta. We run the following transformations:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Type inference</p>
<blockquote>
<div><p>Infer types of all expressions, and fix the types of all local
variables. Local variable types are promoted (for instance float
to double), but cannot change (e.g. string cannot be assigned to
float).</p>
<p>When the type inferencer cannot determine a type, such as when it
calls a Python function or method that is not a Numba function, it
assumes type object. Object variables may be coerced to and from
most native types.</p>
<p>The type inferencer inserts CoercionNode nodes that perform such
coercions, as well as coercions between promotable native types.
It also resolves the return type of many math functions called
in the numpy, math and cmath modules.</p>
<p>Each AST expression node has a Variable that holds the type of
the expression, as well as any meta-data such as constant values
that have been determined.</p>
</div></blockquote>
</li>
<li><p class="first">Transform for loops</p>
<blockquote>
<div><p>Provides some transformations of for loops over arrays to loops
over a range. Iteration over range/xrange is resolved at
compilation time.</p>
<p>What I would like to see is the generation of a RangeNode holding
a ast.Compare and an iteration variable incrementing ast.BinOp.</p>
</div></blockquote>
</li>
<li><p class="first">Low level specializations (LateSpecializer)</p>
<blockquote>
<div><p>This stage performs low-level specializations. For instance it
resolves coercions to and from object into calls such as
PyFloat_FromDouble, with a fallback to Py_BuildValue/PyArg_ParseTuple.</p>
<p>This specializer also has the responsibility to ensure that new
references are accounted for by refcounting ObjectTempNode nodes.
This node absorbs the references and lets parent nodes borrow the
reference. At function cleanup, it decrefs its value. In loops,
it also decrefs any previous value, if set. Hence, these temporaries
must be initialized to NULL.</p>
<p>An object temporary is specific to one specific sub-expression, and
they are not reused (like in Cython).</p>
<p>It also rewrites object attribute access and method calls into
PyObject_GetAttrString etc.</p>
</div></blockquote>
</li>
<li><p class="first">Code generation</p>
<blockquote>
<div><p>Generate LLVM code from the transformed AST.</p>
<p>This should be as minimal as possible, and should <em>not</em> contain
blobs of code performing complex operations. Instead, complex
operations should be broken down by AST transformers into
fundamental operations that are already supported by the AST.</p>
<p>This way we maximize code reuse, and make potential future additions
of different code generation backends easier. This can be taken
only so far, since low-level transformations must also tailor to
limitations of the code generation backend, such as intrinsic LLVM
calls or calls into libc. However, code reuse is especially convenient
in the face of type coercions, which LLVM does not provide any
leniency for.</p>
</div></blockquote>
</li>
</ol>
</div></blockquote>
<dl class="class">
<dt id="numba.transforms.BuiltinResolverMixinBase">
<em class="property">class </em><tt class="descclassname">numba.transforms.</tt><tt class="descname">BuiltinResolverMixinBase</tt><a class="headerlink" href="#numba.transforms.BuiltinResolverMixinBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for mixins resolving calls to built-in functions.</p>
<p>Methods called _resolve_&lt;built-in name&gt; are called to handle calls
to the built-in of that name.</p>
</dd></dl>

<dl class="class">
<dt id="numba.transforms.LateBuiltinResolverMixin">
<em class="property">class </em><tt class="descclassname">numba.transforms.</tt><tt class="descname">LateBuiltinResolverMixin</tt><a class="headerlink" href="#numba.transforms.LateBuiltinResolverMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform final low-level transformations such as abs(value) -&gt; fabs(value)</p>
</dd></dl>

</div>


                </div>
              </div>
            </div>
          </div>
        </div>
        
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row-fluid">
<div class="related navbar ">
  <div class="navbar-inner">
    <ul class="nav pull-right">
      
        <li><a href="../genindex.html" title="General Index" >index</a></li>
        <li><a href="../py-modindex.html" title="Python Module Index" >modules</a></li>
        <li><a href="../index.html">numba 0.7.2-284-g9bab146-dirty documentation</a></li> 
      
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->
      <footer>
          &copy; Copyright 2012-2013, Continuum Analytics.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
      </footer>
      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>