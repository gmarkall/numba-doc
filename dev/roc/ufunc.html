<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5.7. ROC Ufuncs and Generalized Ufuncs &mdash; Numba 0.41.0.dev0+46.g16be3a7-py2.7-linux-x86_64.egg documentation</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/numba-docs.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.41.0.dev0+46.g16be3a7-py2.7-linux-x86_64.egg',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Numba 0.41.0.dev0+46.g16be3a7-py2.7-linux-x86_64.egg documentation" href="../index.html" />
    <link rel="up" title="5. Numba for AMD ROC GPUs" href="index.html" />
    <link rel="next" title="5.8. Examples" href="examples.html" />
    <link rel="prev" title="5.6. The Agents" href="device-management.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/numba_blue_icon_rgb.png"></span>
          Numba</a>
        <span class="navbar-text navbar-version pull-left"><b>0.41</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">1. User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">2. Reference Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cuda/index.html">3. Numba for CUDA GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cuda-reference/index.html">4. CUDA Python Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">5. Numba for AMD ROC GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extending/index.html">6. Extending Numba</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">7. Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proposals/index.html">8. Numba Enhancement Proposals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">9. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">10. Release Notes</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">5.7. ROC Ufuncs and Generalized Ufuncs</a><ul>
<li><a class="reference internal" href="#basic-roc-ufunc-example">5.7.1. Basic ROC UFunc Example</a></li>
<li><a class="reference internal" href="#calling-device-functions-from-roc-ufuncs">5.7.2. Calling Device Functions from ROC UFuncs</a></li>
<li><a class="reference internal" href="#generalized-roc-ufuncs">5.7.3. Generalized ROC ufuncs</a></li>
<li><a class="reference internal" href="#async-execution-a-chunk-at-a-time">5.7.4. Async execution: A Chunk at a Time</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="device-management.html" title="Previous Chapter: 5.6. The Agents"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 5.6. The Agents</span>
    </a>
  </li>
  <li>
    <a href="examples.html" title="Next Chapter: 5.8. Examples"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">5.8. Examples &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/roc/ufunc.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="roc-ufuncs-and-generalized-ufuncs">
<h1>5.7. ROC Ufuncs and Generalized Ufuncs<a class="headerlink" href="#roc-ufuncs-and-generalized-ufuncs" title="Permalink to this headline">¶</a></h1>
<p>This page describes the ROC ufunc-like object.</p>
<p>To support the programming pattern of ROC programs, ROC Vectorize and
GUVectorize cannot produce a conventional ufunc.  Instead, a ufunc-like
object is returned.  This object is a close analog but not fully
compatible with a regular NumPy ufunc.  The ROC ufunc adds support for
passing intra-device arrays (already on the GPU device) to reduce
traffic over the PCI-express bus.  It also accepts a <cite>stream</cite> keyword
for launching in asynchronous mode.</p>
<div class="section" id="basic-roc-ufunc-example">
<h2>5.7.1. Basic ROC UFunc Example<a class="headerlink" href="#basic-roc-ufunc-example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">vectorize</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="nd">@vectorize</span><span class="p">([</span><span class="s">&#39;float32(float32, float32, float32)&#39;</span><span class="p">,</span>
            <span class="s">&#39;float64(float64, float64, float64)&#39;</span><span class="p">],</span>
           <span class="n">target</span><span class="o">=</span><span class="s">&#39;roc&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">roc_discriminant</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>

<span class="c"># prepare the input</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="n">D</span> <span class="o">=</span> <span class="n">roc_discriminant</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>  <span class="c"># print result</span>
</pre></div>
</div>
</div>
<div class="section" id="calling-device-functions-from-roc-ufuncs">
<h2>5.7.2. Calling Device Functions from ROC UFuncs<a class="headerlink" href="#calling-device-functions-from-roc-ufuncs" title="Permalink to this headline">¶</a></h2>
<p>All ROC ufunc kernels have the ability to call other ROC device functions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">vectorize</span><span class="p">,</span> <span class="n">roc</span>

<span class="c"># define a device function</span>
<span class="nd">@roc.jit</span><span class="p">(</span><span class="s">&#39;float32(float32, float32, float32)&#39;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">roc_device_fn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="n">y</span> <span class="o">/</span> <span class="n">z</span>

<span class="c"># define a ufunc that calls our device function</span>
<span class="nd">@vectorize</span><span class="p">([</span><span class="s">&#39;float32(float32, float32, float32)&#39;</span><span class="p">],</span> <span class="n">target</span><span class="o">=</span><span class="s">&#39;roc&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">roc_ufunc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">roc_device_fn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="generalized-roc-ufuncs">
<h2>5.7.3. Generalized ROC ufuncs<a class="headerlink" href="#generalized-roc-ufuncs" title="Permalink to this headline">¶</a></h2>
<p>Generalized ufuncs may be executed on the GPU using ROC, analogous to
the ROC ufunc functionality.  This may be accomplished as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">guvectorize</span>

<span class="nd">@guvectorize</span><span class="p">([</span><span class="s">&#39;void(float32[:,:], float32[:,:], float32[:,:])&#39;</span><span class="p">],</span>
             <span class="s">&#39;(m,n),(n,p)-&gt;(m,p)&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s">&#39;roc&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">matmulcore</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="examples.html#roc-matmul"><span>Matrix multiplication example</span></a>.</p>
</div>
</div>
<div class="section" id="async-execution-a-chunk-at-a-time">
<h2>5.7.4. Async execution: A Chunk at a Time<a class="headerlink" href="#async-execution-a-chunk-at-a-time" title="Permalink to this headline">¶</a></h2>
<p>Partitioning your data into chunks allows computation and memory transfer
to be overlapped.  This can increase the throughput of your ufunc and
enables your ufunc to operate on data that is larger than the memory
capacity of your GPU.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">vectorize</span><span class="p">,</span> <span class="n">roc</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c"># the ufunc kernel</span>
<span class="k">def</span> <span class="nf">discriminant</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>

<span class="n">roc_discriminant</span> <span class="o">=</span> <span class="n">vectorize</span><span class="p">([</span><span class="s">&#39;float32(float32, float32, float32)&#39;</span><span class="p">],</span>
                            <span class="n">target</span><span class="o">=</span><span class="s">&#39;roc&#39;</span><span class="p">)(</span><span class="n">discriminant</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e+8</span><span class="p">)</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>

<span class="c"># prepare the input</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

<span class="c"># create a ROC stream</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">roc</span><span class="o">.</span><span class="n">stream</span><span class="p">()</span>

<span class="n">chunksize</span> <span class="o">=</span> <span class="mf">1e+6</span>
<span class="n">chunkcount</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="n">chunksize</span>

<span class="c"># partition numpy arrays into chunks</span>
<span class="c"># no copying is performed</span>
<span class="n">sA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">chunkcount</span><span class="p">)</span>
<span class="n">sB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">chunkcount</span><span class="p">)</span>
<span class="n">sC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">chunkcount</span><span class="p">)</span>
<span class="n">sD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">chunkcount</span><span class="p">)</span>

<span class="n">device_ptrs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c"># helper function, async requires operation on coarsegrain memory regions</span>
<span class="k">def</span> <span class="nf">async_array</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="n">coarse_arr</span> <span class="o">=</span> <span class="n">roc</span><span class="o">.</span><span class="n">coarsegrain_array</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">coarse_arr</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">arr</span>
    <span class="k">return</span> <span class="n">coarse_arr</span>

<span class="k">with</span> <span class="n">stream</span><span class="o">.</span><span class="n">auto_synchronize</span><span class="p">():</span>
    <span class="c"># every operation in this context with be launched asynchronously</span>
    <span class="c"># by using the ROC stream</span>

    <span class="n">dchunks</span> <span class="o">=</span> <span class="p">[]</span> <span class="c"># holds the result chunks</span>

    <span class="c"># for each chunk</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sA</span><span class="p">,</span> <span class="n">sB</span><span class="p">,</span> <span class="n">sC</span><span class="p">,</span> <span class="n">sD</span><span class="p">):</span>
        <span class="c"># create coarse grain arrays</span>
        <span class="n">asyncA</span> <span class="o">=</span> <span class="n">async_array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">asyncB</span> <span class="o">=</span> <span class="n">async_array</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="n">asyncC</span> <span class="o">=</span> <span class="n">async_array</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">asyncD</span> <span class="o">=</span> <span class="n">async_array</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

        <span class="c"># transfer to device</span>
        <span class="n">dA</span> <span class="o">=</span> <span class="n">roc</span><span class="o">.</span><span class="n">to_device</span><span class="p">(</span><span class="n">asyncA</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">)</span>
        <span class="n">dB</span> <span class="o">=</span> <span class="n">roc</span><span class="o">.</span><span class="n">to_device</span><span class="p">(</span><span class="n">asyncB</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">)</span>
        <span class="n">dC</span> <span class="o">=</span> <span class="n">roc</span><span class="o">.</span><span class="n">to_device</span><span class="p">(</span><span class="n">asyncC</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">)</span>
        <span class="n">dD</span> <span class="o">=</span> <span class="n">roc</span><span class="o">.</span><span class="n">to_device</span><span class="p">(</span><span class="n">asyncD</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c"># no copying</span>

        <span class="c"># launch kernel</span>
        <span class="n">roc_discriminant</span><span class="p">(</span><span class="n">dA</span><span class="p">,</span> <span class="n">dB</span><span class="p">,</span> <span class="n">dC</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">dD</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">)</span>

        <span class="c"># retrieve result</span>
        <span class="n">dD</span><span class="o">.</span><span class="n">copy_to_host</span><span class="p">(</span><span class="n">asyncD</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">)</span>

        <span class="c"># store device pointers to prevent them from freeing before</span>
        <span class="c"># the kernel is scheduled</span>
        <span class="n">device_ptrs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">dA</span><span class="p">,</span> <span class="n">dB</span><span class="p">,</span> <span class="n">dC</span><span class="p">,</span> <span class="n">dD</span><span class="p">])</span>

        <span class="c"># store result reference</span>
        <span class="n">dchunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">asyncD</span><span class="p">)</span>

<span class="c"># put result chunks into the output array &#39;D&#39;</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dchunks</span><span class="p">):</span>
    <span class="n">sD</span><span class="p">[</span><span class="n">i</span><span class="p">][:]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[:]</span>

<span class="c"># data is ready at this point inside D</span>
<span class="k">print</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2012, Anaconda, Inc..<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>